define(function(a){function d(a,d,e,f){var g,h,i,j,k,l;"TEXTAREA"==a.tagName&&"undefined"!=typeof d&&(d=d.toString(),"undefined"==typeof e?(i=c(a),g=i[0],h=i[1]):(g=parseInt(e),h=f||g),j=a.value,k=j.slice(0,g),l=j.slice(h),a.value=k+d+l,b(a,k.length+d.length,0))}var b=function(){var b=a.createElement("textarea");return b.setSelectionRange?function(a,b,c){var c=c||0;setTimeout(function(){a.focus(),a.setSelectionRange(b,b+c)})}:b.createTextRange?function(a,b,c){var d,e;c=c||0,a.focus(),d=a.value.length,e=a.createTextRange(),e.moveStart("character",b),e.moveEnd("character",b+c-d),e.select()}:void 0}(),c=function(){var b=a.createElement("textarea");return"number"==typeof b.selectionStart?function(a){return[a.selectionStart,a.selectionEnd,a.value.slice(a.selectionStart,a.selectionEnd)]}:function(b){var e,f,g,c=0,d=0;if(b.focus(),e=a.selection.createRange(),"TEXTAREA"==b.tagName){for(f=a.body.createTextRange(),f.moveToElementText(b),c=0;f.compareEndPoints("StartToStart",e)<0;c++)f.moveStart("character",1);for(g=0;c>=g;g++)"\n"==b.value.charAt(g)&&c++;for(f.moveToElementText(b),d=0;f.compareEndPoints("StartToEnd",e)<0;d++)f.moveStart("character",1);for(g=0;d>=g;g++)"\n"==b.value.charAt(g)&&d++}return[c,d,selectedTxt,b.value.slice(c,d)]}}();return{insertTxt:d,Selection:Selection,setPosition:b,getPosition:c}});